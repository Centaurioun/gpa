2002-02-10  Peter Gerwinski <peter.gerwinski@g-n-u.de>

	* Makefile.am (LDADD): Added -lm and -lz to the hardcoded libraries.
	(gpa_SOURCES): Added qdchkpwd.c and qdchkpwd.h to the list.

	* qdchkpwd.c, qdchkpwd.h: New files. They contain a "Quick and
	Dirty CHecK for PassWorDs", based on the zlib library.

	* gpa.h: Some code cleaning.

	* gpa.c, icons.c, keyserver.c, keyring.c: Fixed debug output.

	* keyeditdlg.c, keyexportdlg.c, keyserver.c, keygenwizard.c,
	keyring.c, gpawizard.h: Reformatted to completely comply with the 
	GNU Coding Standards.
	
	* fileman.c, filemenu.c, gpawidgets.c: Use the GTK+ 2.0 API for
	finding out the right width for GtkEntry's.

	* keyserver.h, keyserver.c (keyserver_get_current): Added new
	argument that requests that the returned value never be NULL.

	* keyexportdlg.c, keyimportdlg.c, keysmenu.c, optionsmenu.c: Use
	new keyserver_get_current().
	
	* gpa.h, gpa.c (gpa_backup_generated)
	(gpa_set_backup_generated)
	(gpa_remember_backup_generated): New functions for implementing
	new option "backup_generated".

	* gpa.c (cmd_and_opt_values)
	(opts)
	(main): Added oBackupGenerated option. It signals whether the
	user should be warned to generate a backup of his private key.

	* gpafilesel.c (gpa_file_selection_init): Changed "Open" button to
        read "Ok".
	(gpa_file_selection_dir_button)
	(gpa_file_selection_populate): Removed some debug output, other
	fixes.

	* gpawizard.c (gpa_wizard_update_buttons): Disable all buttons
	when in the "wait" page. So, we explicitly enable the "Close"
	button when we reach the last page.

	* helpmenu.c (about_dialog_timer): Fixed wrong call to
	gdk_draw_string.
	(help_about): Added G-N-U GmbH copyright notice and other
	documentation. Changed the way the text widths are calculated.
	(gpa_help_menu_add_to_factory): Renamed help menu to "Info".

	* keyexportdlg.c (export_ok): Cleaned up code a bit, reordered if
	conditions (in preparation for adding export to clipboard).
	
	* keyexportdlg.c, keyexportdlg.h (secret_key_export_dialog_run)
	(key_backup_dialog_run): New dialogues. First exports secret keys,
	and the second makes a backup of the user's keys.

	* keygenwizard.c (gpa_keygen_wizard_password_validate): Added
	check of the strength of the passphrase, using the new qdchkpwd.

	* keyimportdlg.c (import_ok): Cleaned up code a bit, reordered if
	conditions (in preparation for adding import to clipboard).

	* keyring.c (keyring_editor_sign)
	(keyring_editor_import)
	(keyring_editor_export)
	(keyring_editor_export_secret)
	(keyring_editor_backup): Added prototypes.
	(keyring_editor_import): Added support for import from the
	clipboard.
	(keyring_editor_export): Export to clipboard.
	(keyring_editor_export_secret)
	(isdir)
	(keyring_editor_backup): New functions.
	(keyring_editor_mapped): Reordered "if" conditions for speed.
	Enabled key backups.
	(keyring_editor_menubar_new): Changed the various menu items to
	use the keyring_editor_* functions instead of the toolbar ones.
	Added some code, but disabled it (doesn't work).
	(export_secret_key): Removed function.

	* keysmenu.c (gpa_tableKey_new)
	(gpa_frameExpire_new): Changed the way GtkEntries widths are
	calculated.
	
2002-02-05  Peter Gerwinski <peter.gerwinski@g-n-u.de>

	* Makefile.am (gpa_SOURCES): Included gpafilesel.c and gpafilesel.h 
	to the list.

	* harddisk.xpm, harddisk1.xpm, harddisk2.xpm, harddisk3.xpm,
	open_folder.xpm, open_folder1.xpm, open_folder2.xpm, floppy.xpm,
	folder.xpm, folder1.xpm, folder2.xpm: New icons.	
	
	* encryptdlg.c, expirydlg.c, fileman.c, filemenu.c, filesigndlg.c,
	gpawidgets.c, gpawidgets.c, gtktools.c, keygendlg.c,
	keygenwizard.c, keysmenu.c, passphrasedlg.c: Small corrections to
	message strings.

	* encryptdlg.c, fileman.c, filemenu.c, filesigndlg.c,
	gpawidgets.c, keyexportdlg.c, keygendlg.c, keygenwizard.c,
	keyimportdlg.c, keysigndlg.c, keysmenu.c, optionsmenu.c,
	ownertrustdlg.c, passphrasedlg.c: Added casts to remove compile
	time warnings and other code cleanups. Changed comment layout.

	* encryptdlg.c, expirydlg.c, fileman.c, filemenu.c, filesigndlg.c,
	gtktools.c, helpmenu.c, keydeletedlg.c, keyeditdlg.c,
	keyexportdlg.c, keygendlg.c, keygenwizard.c, keyimportdlg.c,
	keysigndlg.c, keysmenu.c, optionsmenu.c, ownertrustdlg.c,
	passphrasedlg.c: Changed to use GTK_WINDOW_TOPLEVEL instead of
	GTK_WINDOW_DIALOG in all calls to gtk_window_new, since
	GTK_WINDOW_DIALOG doesn't exist in GTK+ 2.0.
	
	* fileman.c (show_file_detail)
	filemenu.c (file_encrypt_detail)
	gpawidgets.c (gpa_expiry_frame_new)
	helpmenu.c (help_about)
	keysmenu.c (gpa_tableKey_new): Use the GTK+ 2.0 API for finding out
	the right width for GtkEntry's.

	* gpafilesel.c, gpafilesel.h: New files. They define a version of
	the GtkFileSelection dialog (GpaFileSelection) modified to look
	more like what users of MS-Windows are accustomed to. It is
	directly based on the source code for GTK+ 2.0.

	* icons.c, siglist.c: Formatting change.

	* fileman.c (gpa_fileman_toolbar_new): Use new GTK+ 2.0 API.
	Disabled the help button, since it does nothing at the moment.

	* filemenu.c, gtktools.c, keysmenu.c: Now uses the new GpaFileSelection
	instead of GtkFileSelection.

	* gpa.c: Added include for w32reg.h.
	(gpa_default_key_changed_marshal)
	(gpa_create_default_key_signal): Disabled functions for
	compilation with GTK+ 2.0.
	(main): Fixed several compile time errors on win32. Now we use
	UTF-8 for output.

	* gtktools.c (gpa_button_set_text): Disabled code that doesn't
	compile with GTK+ 2.0.

	* helpmenu.c (scroll_text): Updated.
	(about_dialog_timer)
	(help_about): Use gtk_style_get_font instead of directly accessing
	the style struct.
	(gpa_help_menu_add_to_factory): Disabled help button.

	* keyexportdlg.c (_GPAKeyExportDialog)
	(key_export_dialog_run): Support for exporting keys to the
	clipboard.

	* keygenwizard.c (gpa_keygen_wizard_password_validate): Added
	check for a passphrase that is obviously too simple. At the moment
	that is defined as being less than 10 characters long.

	* keyring.c (keyring_editor_current_key): Removed prototype.
	(toolbar_edit_key)
	(toolbar_remove_key)
	(toolbar_sign_key)
	(toolbar_export_key)
	(toolbar_import_keys): Added prototypes.
	(export_secret_key): New (empty) function.
	(keyring_editor_generate_key_advanced): Changed #warning to a comment.
	(keyring_editor_mapped): Remind the user to make a backup of his 
	private key.
	(keyring_editor_menubar_new): Added keyboard accelerator to the
	File/Close menu item. Added key operations (sign, export, export
	private, backup) to the menu. Moved "Options" menu to before
	"Keys" menu.
	(keyring_toolbar_new): Use new GTK+ 2.0 API. Disabled the help
	button, since it does nothing at the moment. Added button to open
	the file manager.
	(keyring_editor_new): Changed default window size. Increased area
	reserved for the key list.
	
	* keyimportdlg.c (_GPAKeyImportDialog)
	(key_import_dialog_run): Support for exporting keys to the
	clipboard.
	
2002-01-14  Werner Koch  <wk@gnupg.org>

	* gpa.c (my_strusage): Take bug report address from configure.

2001-12-31  Werner Koch  <wk@gnupg.org>

	* gpapastrings.c, gpapastrings.h: Suport for creation dates.
	* keyring.c:Ditto.
	* keyring.c (keyring_update_status_bar): Fixed segv in case a key
	does not exist.  All by Michael Mauch.

	* helpmenu.c (help_warranty): Added real code.  By Michael Fischer
	v. Mollard.

2001-08-23  Werner Koch  <wk@gnupg.org>

	* gpapastrings.c: Added a few more strings and made
	keytrust_strings_advanced code.  By Miguel Coca.

2001-06-06  Werner Koch  <wk@gnupg.org>

	* gpa.c (main): Convert the characters in the homedir from
	backslash to standard slash.  Note: We sill need to figure out a
	way to handle the '\\server\path' style filenames - however, I am
	pretty sure that a lot of other functions are not able to handle
	them.

2001-05-30  Werner Koch  <wk@gnupg.org>

	* i18n.h, options.h: New. 
	* gpa.h: Moved some code to the new header files.

	* keyserver.c, keyserver.h: New.
	* keyexportdlg.c (key_export_dialog_run): Use functions from
	keyserver to setup the list.
	* keyimportdlg.c (key_import_dialog_run): Ditto.
	* optionsmenu.c (options_keyserver): Ditto.
	* gpa.c (main): Ditto.
	* keysmenu.c (keys_openPublic_send_key): Ditto.
	* keyreceivedlg.c (receive_ok):  Ditto.
	* optionsmenu.c (options_keyserver_set): Ditto.
	* gpa.c, gpa.h (global_keyserver): Removed.

	* gpa.c: New option --keyserver.

2001-03-28  Werner Koch  <wk@gnupg.org>

	* gpa.c (gpa_determine_default_key): Replaced xstrdup by
	xstrdup_or_null to avoid a segv. 
	* optionsmenu.c (options_key_set): Ditto, to make it more robust.
	(options_keyserver_set): Ditto.
	* passphrasedlg.c (passphrase_ok): Ditto.
	* keyimportdlg.c (import_ok): Ditto.
	* keygendlg.c (gpa_key_gen_run_dialog): Ditto.
	* keyexportdlg.c (export_ok): Ditto.
	* gtktools.c (file_dialog_ok): Ditto.
	* gpawidgets.c (gpa_secret_key_list_new): Ditto.
	(gpa_public_key_list_new): Ditto.
	* keylist.c (keylist_fill_list): Insert only if we got a keyID.

2001-02-27	Jan-Oliver Wagner <jan@intevation.de>

	* helpmenu.c: Added some authors for scroll text 

2001-02-15  Thomas Koester  <tkoester@intevation.de>

	* gpa.c (i18n_init): call gtk_set_locale even with USE_SIMPLE_GETTEXT
	* keysmenu.c (gpa_frameExpire_at, gpa_frameExpire_after): obsolete

2001-02-15  Bernhard Herzog  <bh@intevation.de>

	* keygenwizard.c (gpa_keygen_wizard_backup_dir_browse): Check for
	a cancelled dialog.

	* encryptdlg.c (file_encrypt_ok, file_encrypt_cancel): Instead of
	quitting the main loop, destroy the dialog window.
	(file_sign_destroy, gpa_file_encrypt_dialog_run):Add a destroy
	event handler and quit the recursive main loop there.Make the
	dialog properly modal.

	* filesigndlg.c (file_sign_ok, file_sign_cancel): Instead of
	quitting the main loop, destroy the dialog window.
	(file_sign_destroy, gpa_file_sign_dialog_run): Add a destroy event
	handler and quit the recursive main loop there.
	(gpa_file_sign_dialog_run): Make the dialog properly modal.

	* gpapastrings.c (gpa_algorithm_from_string): Translate the
	strings before comparing them.

	* gpapastrings.c (gpa_ownertrust_from_string): Translate the
	strings before comparing them.

	* filesigndlg.c (gpa_file_sign_dialog_run): Make the key list
	resize properly

	* helpmenu.c (help_license): Display the text of the GPL, not
	just the title

	* gpa_license.h:
	* gpa_license.c: New file containing the GPL as a C string and the
	corresponding header.

	* Makefile.am (gpa_SOURCES): Add the new files

	* icons.xpm:
	* icons.c (xpms): Add the new logo

	* helpmenu.c (about_dialog_logo_expose, about_dialog_load_logo)
	removed. The logo is now an xpm just lkike the icons.
	(help_about): Use a pixmap widget instead of the drawing area to
	display the logo

	* keygenwizard.c (page_switched): Remove a debug printf
	(gpa_keygen_wizard_backup_page): Change the wording a little

	* gpa_logo.ppm: Update to new logo

	* gpawizard.c (GPAWizard):
	(gpa_wizard_new): Add some fields for a callback that's called
	whenever a page is switched. (This should really be implemented as
	a GTK signal)
	(gpa_wizard_set_page_switched): Call the callback
	(gpa_wizard_page_switched): Set the callback
	(gpa_wizard_notebook_destroy): New. Handler for the notebook's
	destroy signal to remove the callback to avoid segfaults
	(gpa_wizard_new): Connect to the notebook's destroy signal.

	* gpawizard.h: Add the new type and prototype

	* keygenwizard.c (gpa_keygen_wizard_password_validate,
	gpa_keygen_wizard_backup_action,
	gpa_keygen_wizard_backup_dir_action): Don't change the pixmap.
	(page_switched): Callback for the page switches of the wizard.
	Change the pixmap depending on the current page.

	* icons.xpm: Tweak the import icon a little

	* keylist.c (gpa_keylist_update_list): Update the column widths
	also when the list was empty before

2001-02-14  Bernhard Herzog  <bh@intevation.de>

	* keyring.c (keyring_editor_import): Update the widgets after
	importing the key
	(keyring_toolbar_new): Change "details" to "detailed"

	* icons.xpm: 
	* icons.c (xpms): Add some new graphics

	* keyring.c (keyring_toolbar_new): 
	* fileman.c (gpa_fileman_toolbar_new): Use the new toolbar icons

	* keylist.c (get_key_type_pixmap_value): Use the new key icons

	* keygenwizard.c: Add an option to create backup copies of the
	keys and add some graphics:
	(GPAKeyGenWizard): Add a few fields for the backup feature and the
	graphics
	(gpa_keygen_wizard_password_page): The passphrase page is not the
	last page before the actual key generation anymore, so change the
	wording.
	(gpa_keygen_wizard_password_validate): Now used directly as the
	action callback of the passphrase page, so change it display the
	messages instead of returning them and return the appropriate
	boolean.
	(gpa_keygen_wizard_backup_page):
	(gpa_keygen_wizard_backup_action):
	(gpa_keygen_wizard_backup_dir_page):
	(gpa_keygen_wizard_backup_get_text):
	(gpa_keygen_wizard_backup_dir_action): New functions implementing
	the backup pages, actions and helper functions.
	(gpa_keygen_generate_key): Store the generated keys in the
	keygenwizard struct
	(gpa_keygen_wizard_generate_action): Remove the password
	validation because that's already been done. Create the backups
	after generating the key pair.
	(free_keygen_wizard): New function to free the keygenwizard struct
	and the file names.
	(gpa_keygen_wizard_run): Add the new pages and the pixmap window
	(isdir):
	(file_dirname): Two new helper functions

2001-02-13  Thomas Koester  <tkoester@intevation.de>

	* expirydlg.c (gpa_expiry_dialog_run): Conflicting accelerator.

2001-02-13  Bernhard Herzog  <bh@intevation.de>

	* keysmenu.c (gpa_tableKey_new): Swap the table rows and change
	the labels to be more consistent with the rest of the UI.

	* keyring.c (keyring_editor_mapped): Add accelerators for the
	message box

	* gtktools.c (gpa_message_box_run): Add an accelgroup and handle
	accelerators in the button labels.

	* keyimportdlg.c (key_import_dialog_run): Make the accelerators
	for the radio buttons and entry fields work

	* keyeditdlg.c (gpa_key_edit_dialog_run): Remove the sign frame.
	Add an accel-group and make the accelerators work.

2001-02-13  Thomas Koester  <tkoester@intevation.de>

	* expirydlg.c (expiry_ok):
	(gpa_expiry_dialog_run):
	keydeletedlg.c (gpa_delete_dialog_run):
	* keyexportdlg.c (key_export_dialog_run):
	* keyimportdlg.c (key_import_dialog_run): Use "_OK" instead of "Ok".

	* keyeditdlg.c (gpa_key_edit_dialog_run):
	* gpawizard.c (gpa_wizard_new):
	* keyexportdlg.c (key_export_dialog_run):
	* keyimportdlg.c (key_import_dialog_run): Add/Change accelerators.

2001-02-13  Bernhard Herzog  <bh@intevation.de>

	* gpawizard.h: Add prototype of gpa_wizard_next_page

	* gpawizard.c (gpa_wizard_next_page):
	(gpa_wizard_next): Put practically all of gpa_wizard_next in the
	new public function gpa_wizard_next_page and just call the public
	function in gpa_wizard_next. The user data parameter of
	gpa_wizard_next is now the vbox widget.
	(gpa_wizard_new): Pass the vbox widget as parameter to the
	Next-button's callback.

	* keygenwizard.c (switch_to_next_page): New. Handler for the
	activate signals of several entry fields to switch the wizard to
	the next page
	(gpa_keygen_wizard_simple_page): Add the keygen_wizard as
	parameter and connect to the entry's activate signal to switch to
	the next page.
	(gpa_keygen_wizard_comment_page):
	(gpa_keygen_wizard_email_page):
	(gpa_keygen_wizard_name_page): Add the keygen_wizard as parameter
	and pass it through to gpa_keygen_wizard_simple_page
	(focus_repeat_passphrase): New. Handler for the activate signal of
	the passphrase entry to focus the repeat passhrase entry
	(gpa_keygen_wizard_password_page): Add the keygen_wizard as
	parameter and connect to the repeat pasphrase entry's activate
	signal to switch to the next page. Also focus the repeat entry in
	the activate handler of the passphrase entry.

	* siglist.c (gpa_siglist_set_signatures): Call
	gtk_container_check_resize to make sure that the sizes of the
	title buttons are also taken into account.

	* keyexportdlg.c (key_export_dialog_run): Use function from
	gtktools.c to create the radio buttons, so that the accelerators
	are handled correctly.

2001-02-13  Thomas Koester  <tkoester@intevation.de>

	* gtktools.c (gpa_window_error):
	(gpa_window_message): Translate window titles.
	* keygenwizard.c (gpa_keygen_wizard_run): Use "Finish" button
 	instead of "Next" on wait_page and final_page.
	* gpawizard.c (gpa_wizard_new): Add accelerator to "Next" and "Prev"

2001-02-13  Bernhard Herzog  <bh@intevation.de>

	* Makefile.am (install-data-local):
	(pkgdata_DATA): Remove install-data-local and use pkgdata_DATA to
	install data files.

	(logo):
	(EXTRA_DIST): Add the gpa logo file and put it into pkgdata_DATA
	and EXTRA_DIST

	* helpmenu.c (about_dialog_load_logo): Take the logo from the data
	dir.

	* keygendlg.c (gpa_key_gen_run_dialog): Add some comments

2001-02-13	Jan-Oliver Wagner <jan@intevation.de>

	* hidewnd.c (new): Hiding console window on W98 and ME
	* hidewnd.h (new): Hiding console window on W98 and ME
	* Makefile.am: added hidewnd.(h|c)
	* gpa.c (main): added hiding of console window for W98, ME

2001-02-12  Bernhard Herzog  <bh@intevation.de>

	* optionsmenu.c (options_recipients):
	(options_key): Translate the CList column titles
	(options_keyserver): Translate the buttons

	* keyring.c (keyring_details_page_fill_key):
	(keyring_details_notebook):
	(GPAKeyringEditor): Add the owner trust to the details page.

	* gpapastrings.c (gpa_ownertrust_string):
	(gpa_unit_expiry_time_string): Translate the returned strings.

	* keyring.c (keyring_editor_new): Mark the big label for
	translation

	* keylist.c (gpa_keylist_update_list): Call
	gtk_container_check_resize to make sure that the size changes in
	the title buttons are correctly accounted for
	(ColumnDef): title may now be NULL to indicate an empty title.
	(keylist_fill_row): Handle NULL column titles.

	* keyring.c (keyring_editor_mapped): Check for cancelling the
	dialog via WM, in which case result is NULL

	* fileman.c (gpa_fileman_toolbar_new): Use the new help icon

	* gpapastrings.c (algorithm_strings): Add a missing ')'

	* gtktools.c (GPASaveFileNameDialog): Rename the dialog field to
	window as it's done in all other dialogs
	(file_dialog_destroy):
	(gpa_get_save_file_name): Add a destroy event handler and quit the
	recursive main loop there.
	(file_dialog_ok):
	(file_dialog_cancel): Instead of quitting the main loop, destroy
	the dialog window.

	* gpa.c (gpa_addRecipient): Only add the key if it's not already
	in the recipients list.

	* keysmenu.c (keys_openPublic_exportTrust_export): 
	(keys_openPublic_exportTrust): 
	(keys_openSecret_editKey_close): 
	(keys_openSecret_editKey): 
	(keys_openSecret): 
	* filemenu.c (file_sign_sign):
	(file_encryptAs):
	(file_protect):
	(file_protectAs): Don't translate the tip-strings. They aren't
	used anymore at all and should be removed completely evetually.

	* gpa.c (gpa_open_keyring_editor):
	(gpa_open_filemanager): Only do a show_all once, when the window
	is created for the first time. With recent changes not all
	children of the keyring editor window are shown all the time and a
	show_all will make them all visible again.

	* fileman.c (gpa_fileman_new): 
	* keyring.c (keyring_editor_new): Realize the window before
	creating the toolbar so that we can create pixmaps without
	warnings

	* keyring.c (keylist_columns_brief):
	(keylist_columns_detailed): Add the new key type pixmap as the
	first column

	* keylist.h (GPAKeyListColumn):
	* keylist.c (column_defs):
	(get_key_type_pixmap_value): New value func and column defintion
	to return a pixmap indicating the type of key: public only or
	secret+public.

	* keylist.c (ColumnValueFunc):
	(ColumnDef):
	(get_name_value):
	(get_trust_value):
	(get_ownertrust_value):
	(get_expirydate_value):
	(get_identifier_value): Change the prototype of ColumnValueFunc
	and update all value functions accordingly. Now the value may be a
	pixmap, but all existing functions only rerturn text as before.
	The function itself now also indicates whether the text has to be
	freed.
	(keylist_row_labels):
	(keylist_free_row_labels): Removed.
	(keylist_fill_row): New function to fill a row with the
	labels/pixmaps for one key
	
	* keyring.c (keyring_toolbar_new): Use the new help icon

	* icons.xpm: 
	* icons.c (xpms): Add some new icons

	* keyring.c (keyring_editor_delete): Deleting keys has changed in
	gpapa, so call either gpapa_secret_key_delete or
	gpapa_public_key_delete, depending on whether there's a secret key
	or not.

2001-02-09  Bernhard Herzog  <bh@intevation.de>

	* keyring.c (key_has_been_signed): New function to test whether a
	key has been signed by a given other key id
	(keyring_editor_can_sign): Use the new function
	(keyring_editor_sign): For each key, test whether it has already
	been signed by the secret key.

	* keygenwizard.c (string_strip_dup): Helper function to create a
	copy of a string stripped off leading and trailing whitespace
	(gpa_keygen_wizard_simple_get_text): Return a string_strip_dup'ed
	version of the user input
	(gpa_keygen_wizard_password_action): Free the values read from the
	"simple pages" because they're now malloced copies.
	(gpa_keygen_wizard_name_validate):
	(gpa_keygen_wizard_email_validate): New functions to validate the
	user input for the name and email pages. The validation for the
	emails address could be much more thorough.
	(gpa_keygen_wizard_run): Hook up the new validation functions with
	the pages.

	* optionsmenu.c (options_keyserver):
	(options_keyserver_destroy): Make the default key server dialog
	properly modal with a recursive main loop and a handler for the
	destroy signal
	(options_keyserver_set): Actually set the default key server.

	* optionsmenu.h: Remove the prototypes of functions that are long
	gone or that are now static

	* optionsmenu.c (options_recipients_fillDefault):
	(options_recipients_set):
	(options_recipients):
	(options_key):
	(options_key_set):
	(options_key_select):
	(options_keyserver):
	(options_keyserver_set): Make them static. They're only used in
	this file.

	* keyring.c (toolbar_edit_key): Update the details notebook too
	when the key has been changed

	* keyeditdlg.c (key_edit_change_expiry): Set the key_has_changed
	flag if the date has been changed

	* keyring.c (keyring_details_notebook): Add a missing : in the key
	type label

	* helpmenu.h
	* helpmenu.c (help_license):
	(help_about):
	(help_warranty): Make them static and remove them from the header
	file as they're only used in helpmenu.c.

	* helpmenu.c (help_license_destroy):
	(help_license): Make the default license dialog properly modal
	with a recursive main loop and a handler for the destroy signal

	* optionsmenu.c (options_key):
	(options_key_destroy): Make the default key dialog properly modal
	with a recursive main loop and a handler for the destroy signal
	(options_recipients):
	(options_recipients_destroy): Make the default recipients dialog
	properly modal with a recursive main loop and a handler for the
	destroy signal

	* filesigndlg.c (file_sign_ok): Pass the selected secret key to
	the passphrase dialog

2001-02-08  Bernhard Herzog  <bh@intevation.de>

	* keyring.c (keyring_editor_new): Initialize the details notebook
	properly
	(keyring_details_page_fill_key):
	(keyring_details_notebook): Add some new fields to the details
	page.
	(keyring_details_page_fill_key): Add the secret key as a parameter
	to be able to show whether the key is owned by the user
	(idle_update_details): Determine the secret key too to pass to
	keyring_details_page_fill_key

	* expirydlg.c (gpa_expiry_dialog_run): Pass the secret key into
	the dialog instead of the expiry date so that we can display it in
	the password dialog. Update the headerfile accordingly.
	(GPAExpiryDialog): Add the key field.
	(expiry_ok): Pass the key to the password dialog.

	* keyeditdlg.c (key_edit_change_expiry): gpa_expiry_dialog_run has
	a new calling sequence.

	* gpawidgets.c (gpa_key_info_new): Tweak the spacing a bit

	* passphrasedlg.c (gpa_passphrase_run_dialog): Add a label asking
	for the passphrase

	* keysigndlg.c (key_sign_ok): Pass the default key to the password
	dialog

	* passphrasedlg.h (gpa_passphrase_run_dialog): 
	* passphrasedlg.c (gpa_passphrase_run_dialog): Add a key parameter
	and display information about the key whose password is required.

	* keysigndlg.c (key_sign_ok): 
	* filesigndlg.c (file_sign_ok): 
	* fileman.c (decrypt_files): 
	* expirydlg.c (expiry_ok): Call gpa_passphrase_run_dialog with
	NULL as the new key parameter. Should be replaced with the correct
	key later.

	* keyring.c (keyring_editor_toggle_show_trust): Removed because
	it's no longer used. A similar effect is available with the
	brief/detailed listings.
 
	* keydeletedlg.h:
	* keydeletedlg.c: New files for the key delete dialog.

	* Makefile.am (gpa_SOURCES): Add the new key delete dialog files.

	* keyring.c (keyring_editor_delete): Use the new delete dialog
	instead of a simple message box.

	* gpawidgets.h (gpa_key_info_new):
	* gpawidgets.c (gpa_key_info_new): New function to create a simple
	table with info about a key.

	* keygenwizard.c (GPAKeyGenWizard): Add fields for the wizard
	widget and the wait-page.
	(gpa_keygen_wizard_password_action): Switch to the wait-page.
	(gpa_keygen_wizard_wait_page): New function to create the
	wait-page.
	(gpa_keygen_wizard_run): Put the waitpage into the wizard. Also,
	store the gpa wizard widget in the struct.

	* gpawizard.h (gpa_wizard_next_page_no_action):
	* gpawizard.c (gpa_wizard_next_page_no_action): New public
	function to switch the wizard to the next page without running the
	action callback associated with the page. This is used by the
	action callback that is invoked by the finish button to display a
	"wait" message.

2001-02-07  Thomas Koester  <tkoester@intevation.de>

	* gpapastrings.c (gpa_expiry_date_string): Use %x instead of
	  %d.%m.%Y as date format string.
	
	* expirydlg.c (gpa_expiry_dialog_run):
	* gpawidgets.c (gpa_expiry_frame_at):
	(gpa_expiry_frame_new):
	* keysmenu.c (gpa_frameExpire_at):
	(gpa_frameExpire_new): Use gpa_expiry_date_string.

	* keyring.c (keyring_details_page_fill_key): free unused text.

2001-02-07  Bernhard Herzog  <bh@intevation.de>

	* gpawidgets.h (gpa_signature_list_new):
	* gpawidgets.c (add_sigs_to_clist):
	(gpa_signature_list_new): Removed. Superseded by the siglist in
	siglist.c

	* fileman.c (show_file_detail): Use the siglist to display the
	list of signatures

	* siglist.h: Change the include guard to something more unique

	* keyring.c (keyring_editor_sign):
	(keyring_selection_update_widgets): Use the new
	keyring_update_details_notebook function to update the pages in
	the details notebook
	(keyring_details_notebook): Add a label to the details page and
	introduce a vbox holding both the label and the table so that we
	can switch between either the label or the table to show very
	different information when exactly one key is selected or when
	zero or more than one key is selected

	(keyring_update_signatures_page):
	(keyring_update_details_page): Removed
	(keyring_details_page_fill_key):
	(keyring_details_page_fill_num_keys):
	(keyring_signatures_page_fill_key):
	(keyring_signatures_page_empty):
	(idle_update_details):
	(keyring_update_details_notebook): New functions replacing
	keyring_update_details_page and keyring_update_signatures_page so
	that either the details of the current key is shown or the number
	of selected keys if several or no key is selected. Also only
	update the notebook when idle.
	(GPAKeyringEditor): Add some new fields for the new widgets and
	idle handling
	(keyring_editor_new): Initialize the idle handler id.

	* keylist.h (gpa_keylist_selection_length):
	* keylist.c (gpa_keylist_selection_length): New function to
	determine the number of selected keys

	* keyring.c (keyring_editor_generate_key_advanced): Pass the
	password to gpapa_key_set_expiry_date

	* keysmenu.c (keys_openSecret_editKey_close):
	(keys_openSecret_editKey_close): Provide dummy passwords for
	gpapa_key_set_expiry_date just to make them compile. The functions
	are currently unused.

	* keyeditdlg.c (key_edit_change_expiry): Use the new password
	parameter of the expiry dialog and pass it to gpapa.

	* expirydlg.h (gpa_expiry_dialog_run):
	* expirydlg.c (gpa_expiry_dialog_run): Add a parameter to return
	the password
	(GPAExpiryDialog): Add a field for the password
	(expiry_ok): Ask for the password and set the password field in
	the dialog struct

2001-02-06  Bernhard Herzog  <bh@intevation.de>

	* gpa.h (global_defaultKey): Removed. Its definition was deleted
	some time ago.
	
	* gpa.h (global_homeDirectory): 
	* gpa.c (global_homeDirectory): Removed as it's no longer used.

	* gpa.c (main): Don't init the home dir and load/save options dialogs.

	* optionsmenu.c (homeDirSelect):
	(loadOptionsSelect):
	(saveOptionsSelect):
	(gpa_homeDirSelect_ok):
	(gpa_homeDirSelect_init):
	(gpa_loadOptionsSelect_ok):
	(gpa_loadOptionsSelect_init):
	(gpa_saveOptionsSelect_ok):
	(gpa_saveOptionsSelect_init):
	(options_homedir):
	(options_load):
	(options_save): Removed. Loading and saving options wasn't
	actually implemented in gpapa anyway and the home directory was
	only used by the load/save options functions. 
	(gpa_options_menu_add_to_factory): Remove the menu entries for the
	home directory and loading/saving options.

	* fileman.c (decrypt_files): Update cur to the next list element
	at the end of the while loop.

	* helpmenu.c: Reformat several functions to conform more to GNU
	standards.
	(about_dialog_logo_expose): Don't add new timers here. Should fix
	the segfaults that happened when the about dialog was closed.

	* Makefile.am (gpa_SOURCES): Replace the keyreceivedlg files with
	the keyimportdlg files.

	* keyimportdlg.h: 
	* keyimportdlg.c: New files implementing the import dialog

	* keyring.c (keyring_editor_import):
	(keyring_editor_receive): Rename keyring_editor_receive to
	keyring_editor_import and implement it with the new import dialog
	(toolbar_import_keys): call keyring_editor_import.

2001-02-05  Bernhard Herzog  <bh@intevation.de>

	* keyring.c (keyring_editor_export): Use the server returned by
	the dialog and not the default server.

	* siglist.c (GPASigList):
	(gpa_siglist_new):
	(gpa_siglist_set_signatures): Don't try to be too clever about
	when to set the columns to their optimal widths. Do it whenever
	the list is changed and get rid of the widths_set flag.

	* keyring.c (keyring_editor_export): Actually call the appropriate
	gpap functions and handle sending keys to key servers as well.

	* keyexportdlg.h: 
	* keyexportdlg.c: Substantial changes in practically all functions
	to extend the dialog to support sending keys to key servers (which
	includes a new parameter in key_export_dialog_run) as well and to
	handle delete-event and destroy correctly.

2001-02-02  Bernhard Herzog  <bh@intevation.de>

	* gpa.c (gpa_removeRecipients): Change "files" to "keys" in the
	error message when no items are selected

	* keyring.c (toolbar_export_key): Call keyring_editor_export

	* gtktools.c (gpa_window_show_centered): Set the WM_TRANSIENT_FOR
	window manager hint so that the window manager treats dialog
	windows properly

	* keyring.c (keyring_toolbar_new): Correct the tooltip for the
	remove button

2001-02-01  Bernhard Herzog  <bh@intevation.de>

	* Makefile.am (gpa_SOURCES): Add the new expiry dialog files

	* expirydlg.h: 
	* expirydlg.c: New files implementing the dialog to change the
	expiry date

	* keyeditdlg.c (key_edit_change_expiry): New function. Handler for
	the change button of the expiry date
	(gpa_key_edit_dialog_run): Add the signal handler for the expiry
	date change
	
	* keyring.c (keyring_editor_generate_key_advanced): 
	* keygenwizard.c (gpa_keygen_wizard_password_action): Remove some
	debug printfs

	* gtktools.c (GPAMessageBox):
	(message_box_clicked):
	(message_box_destroy):
	(message_box_delete):
	(gpa_message_box_run): Connect to destroy instead of delete-event
	and quit the main loop there. Also introduce the struct
	GPAMessageBox to pass data to the various signal handlers and
	results back to the message box function.

	* keyring.c (keyring_editor_delete): Check whether the return
	value from the message box is NULL, too, when checking for
	"cancel". (it may be null if the user exited the message box
	through the window manager)

	* keyeditdlg.c (key_edit_change_trust): 
	* ownertrustdlg.h (gpa_ownertrust_run_dialog): 
	* ownertrustdlg.c (gpa_ownertrust_run_dialog): Remove the tip
	parameter of gpa_ownertrust_run_dialog which was intended for the
	now removed tip window. Update callers.

	* keyring.c (keyring_editor_can_sign): Don't check explicitly
	whether the selected key is the default key because the list of
	signatures contains the self signature now.

2001-01-31  Bernhard Herzog  <bh@intevation.de>

	* gpa.h (global_noTips):
	* gpa.c (global_noTips): Removed. not needed anymore now that the
	tip window's gone

	* optionsmenu.c (gpa_options_menu_add_to_factory): Remove the
	"Online _tips" entry

	* optionsmenu.h (options_tips): 
	* optionsmenu.c (options_tips): 
	* gpa.h (gpa_switch_tips): 
	* gpa.c (gpa_switch_tips): Removed because they're not needed
	anymore now that the tip window's gone

	* keyring.c (keyring_update_status_bar): Make the parameter
	explicitly a GPAKeyringEditor pointer because it's not directly
	used as a signal handler anymore
	(keyring_default_key_changed): New signal handler for the
	gpa_default_key_changed signal that updates the statusbar and the
	selection sensitive widgets because some of them depend on the
	default key
	(keyring_editor_new): Use keyring_default_key_changed as the
	handler for gpa_default_key_changed
	(keyring_editor_sign): Update the selection sensitive widgets too
	because some depend on what signatures a key has.

	* keysmenu.h: Remove the prototypes of the functions deleted from
	keysmenu.c

	* keysmenu.c (keys_generateKey):
	(keys_generateKey_generate):
	(keys_openPublic):
	(keys_openPublic_evalMouse):
	(keys_openPublic_toggleClistKeys):
	(keys_openPublic_fillClistKeys):
	(keys_openPublic_receive):
	(keys_openPublic_receive_receive):
	(keys_openPublic_editKey):
	(keys_openPublic_sign):
	(keys_openPublic_sign_exec):
	(keys_openPublic_editTrust):
	(keys_openPublic_editTrust_accept):
	(keys_openPublic_delete):
	(getStringForKeytrust):
	(getOwnertrustForString):
	(writtenKeytrust):
	(writtenOwnertrust):
	(unitTime):
	(writtenAlgorithm): Removed because they're not used anymore.

	* optionsmenu.c (gpa_homeDirSelect_init):
	(gpa_loadOptionsSelect_init):
	(gpa_saveOptionsSelect_init): Remove commented out window tip code

	* encryptdlg.c: 
	* fileman.c: 
	* filemenu.c: 
	* filesigndlg.c: 
	* gpa.c: 
	* gpawidgets.c: 
	* gtktools.c: 
	* optionsmenu.c: Don't include help.h

	* tipwindow.c: 
	* help.h:
	* help.c: Removed because the tip windows are not used anymore.
	tipwindow.c wasn't actually used anyway
	
	* Makefile.am (gpa_SOURCES): Removed help.c and help.h

	* gpa.c (main): Don't init the tipwindow.

	* optionsmenu.c (options_homedir):
	(options_load):
	(options_save): Remove the gpa_window_tip_show calls.

	* gtktools.c (gpa_window_destroy): Remove the window tip handling

	* filemenu.c (file_open):
	(gpa_fileOpenSelect_init): 
	(file_open_ok): 
	(file_showDetail): 
	(file_close): 
	(file_sign): 
	(get_file_selection_count): 
	(file_encrypt):
	(file_decrypt_decrypt_exec):
	(file_decrypt_decrypt):
	(file_decrypt): Remove because they're not used anymore

	* filemenu.h: Removed the prototypes of the functions removed from
	filemenu.c

	* gtktools.h (gpa_widget_set_centered):
	* gtktools.c (gpa_widget_set_centered): Removed. Use
	gpa_window_show_centered instead

	* gtktools.c (gpa_window_passphrase): 
	(gpa_window_message): 
	* helpmenu.c (help_license): Use gpa_window_show_centered instead
	of gpa_widget_set_centered.

	* gtktools.h (gpa_widget_show):
	* gtktools.c (gpa_widget_show): Removed. Use
	gpa_window_show_centered instead

	* encryptdlg.c (gpa_file_encrypt_dialog_run): 
	* fileman.c (show_file_detail): 
	* filemenu.c (file_showDetail): 
	(file_sign_dialog): 
	(file_encrypt_detail): 
	(file_encrypt_dialog): 
	(file_protect_dialog): 
	(file_decryptAs): 
	* filesigndlg.c (gpa_file_sign_dialog_run): 
	* gtktools.c (gpa_window_error): 
	* keyexportdlg.c (key_export_dialog_run): 
	* keyreceivedlg.c (key_receive_run_dialog): 
	* keysmenu.c (keys_export_dialog): 
	(keys_openPublic_editTrust): 
	(keys_openPublic_editKey): 
	(keys_openPublic_receive): 
	(keys_openPublic_exportTrust): 
	(keys_openPublic): 
	(keys_openSecret_editKey): 
	(keys_openSecret): 
	(keys_generateKey): 
	(keys_generateRevocation): 
	(keys_import): 
	(keys_importOwnertrust): 
	* optionsmenu.c (options_keyserver): 
	(options_recipients): 
	(options_key): 
	(options_tips): 
	Call gpa_window_show_centered instead of gpa_widget_show

	* keygendlg.c (gpa_key_gen_run_dialog): Remove the commented out
	gpa_widget_show call

	* keyring.c (keyring_editor_edit_trust): Removed because its now
	replaced by the key edit dialog.

	* keygenwizard.c (gpa_keygen_wizard_destroy):
	(gpa_keygen_wizard_run): Add a destroy event handler and quit the
	recursive main loop there.
	(gpa_keygen_wizard_close): Instead of quitting the main loop,
	destroy the dialog window. Also, use the correct prototype.

	* keysigndlg.c (gpa_key_sign_run_dialog): Make sure dialog.result
	is set to FALSE by default.

2001-01-30  Bernhard Herzog  <bh@intevation.de>

	* keysigndlg.c (key_sign_destroy):
	(gpa_key_sign_run_dialog): Add a destroy event handler and quit
	the recursive main loop there.
	(key_sign_cancel):
	(key_sign_ok): Instead of quitting the main loop, destroy the
	dialog window.
	(key_sign_delete): Removed because the default handler does
	exactly what we need now.
	(GPAKeySignDialog):
	(key_sign_ok): Remove the clist_keys field completely and don't
	access it in key_sign_ok.

	* ownertrustdlg.c (ownertrust_ok):
	(ownertrust_cancel): Fix comments

	* passphrasedlg.c (passphrase_destroy):
	(gpa_passphrase_run_dialog): Add a destroy event handler and quit
	the recursive main loop there.
	(passphrase_ok):
	(passphrase_cancel): Instead of quitting the main loop, destroy
	the dialog window.
	(passphrase_delete_event): Removed because the default handler
	does exactly what we need now.
	(gpa_passphrase_run_dialog): use gtk_window_set_modal to get a
	modal dialog and focus the password entry widget
	(GPAPassphraseDialog): Add the window field to pass the dialog
	window into the callbacks.

	* ownertrustdlg.c: Add comments
	(ownertrust_ok):
	(ownertrust_cancel): Destroy the dialog window
	(gpa_ownertrust_run_dialog):
	(ownertrust_destroy): Add a destroy event handler and quit the
	recursive main loop there.
	(ownertrust_delete_event): Removed because the default handler
	does exactly what we need now.
	(gpa_ownertrust_run_dialog): Use gpa_window_show_centered instead
	of gpa_widget_show and use gtk_window_set_modal to get a modal
	dialog

	* keyeditdlg.c (gpa_key_edit_dialog_run):
	(key_edit_destroy): Add a destroy event handler and quit the
	recursive main loop there.
	(key_edit_close): Destroy the dialog window. Quitting the mainloop
	is now handled in the destroy callback.
	(key_edit_delete_event): Removed because the default handler does
	exactly what we need now.

	* keyeditdlg.h: 
	* keyeditdlg.c: New files implementing the key edit dialog (still
	incomplete, though)

	* Makefile.am (gpa_SOURCES): Add the edit dialog files

	* keyring.c (toolbar_edit_key): Run the key edit dialog

2001-01-26  Bernhard Herzog  <bh@intevation.de>

	* keyring.c (keyring_editor_new): Initialize the status bar
	properly

	* gpa.c (gpa_update_default_key): If the default key is not set
	yet, set it to (an approximation of) gpg's default key.
	(gpa_determine_default_key): Make it static. It's better to use
	gpa_update_default_key now.
	* gpa.h: Update the prototypes accordingly.

	* gpa.c (main): 
	* keyring.c (keyring_editor_generate_key_simple): 
	(keyring_editor_generate_key_advanced): 
	Use gpa_update_default_key instead of gpa_determine_default_key

	* keyring.c (keyring_editor_mapped): Fix a typo
	(keyring_statusbar_new): new function to create a status bar
	showing the default key
	(GPAKeyringEditor): Add the labels of the status bar.
	(keyring_update_status_bar): New function to update the status bar
	whenever the default key changes.
	(keyring_editor_new): Add the status bar.

	* gpa.h: Add the prototypes for gpa_get_keyring_editor and
	gpa_get_filenamager

	* gpa.c (gpa_default_key_changed_marshal):
	(gpa_create_default_key_signal):
	(gpa_emit_default_key_changed): New functions to implement a user
	signal "gpa_default_key_changed" for GtkWindows that is emit on
	all toplevel windows whenever the default key changes.
	(main): Initialize the user signal 
	(gpa_set_default_key): Emit the new signal when the key changes.
	(gpa_get_keyring_editor): New function to return the keyring
	editor window
	(gpa_get_filenamager): New function to return the filemanager
	editor window

	* keyring.c (keyring_editor_new): Remove the close button.

2001-01-25  Bernhard Herzog  <bh@intevation.de>

	* filemenu.c: 
	* gtktools.c: 
	* helpmenu.c: 
	* keysmenu.c: 
	* optionsmenu.c: Replace all those silly _("") with ""

2001-01-25	Jan-Oliver Wagner <jan@intevation.de>

	* simple-gettext.c (get_string): removed  ISO-8859-1 to IBM-CP-850
	conversion (assuming .mo file is adequately encoded)

2001-01-24  Bernhard Herzog  <bh@intevation.de>

	* keyring.c (keyring_update_signatures_page): Don't list the self
	signaturs in simplified UI mode.

	* siglist.c: Add some comments

	* siglist.h: 
	* siglist.c (gpa_siglist_set_signatures): Add a key_id parameter
	to filter out signatures of a given key. Useful to hide the self
	signatures of keys.

	* keyring.c (keyring_editor_new): Make the scrollbars of the
	keylist appear automatically.
	(keyring_editor_new): Put the keylist and the details notebook
	into a paned window so that users can allocate the vertical space
	for the widgets. Clean up the code a bit, too.

	* Makefile.am (gpa_SOURCES):
	* siglist.h: 
	* siglist.c: New files implementing the list of signatures in the
	keying editor.

	* keyring.c (keyring_details_notebook): Add the signatures page
	(keyring_update_signatures_page): New function to update the
	signatures page
	(keyring_selection_update_widgets): Update the signatures page
	too.
	(GPAKeyringEditor): Add the signatures list widget

	* keylist.c: Remove some uneeded includes
	
	* keylist.c (keylist_fill_list): Try to keep the current selection
	if the new keep_selection parameter is TRUE.
	(gpa_keylist_update_list): Keep the current selection.

	* keyring.c (keylist_columns_detailed):
	(keylist_columns_brief): Put the name at the end.

	* keylist.c (gpa_keylist_update_list): Make all columns have the
	optimal width.
	(gpa_keylist_new): Use gpa_keylist_update_list to fill the keylist
	and create the title buttons, so that the columns havethe optimal
	width.

2001-01-23  Bernhard Herzog  <bh@intevation.de>

	* keyring.c (keyring_toolbar_new): Add buttons for brief and
	detailed listing.
	(keyring_set_brief_listing):
	(keyring_set_detailed_listing): New. Signal handlers for the diref
	and detailed listing buttons of the toolbar.
	(keylist_columns_detailed):
	(keylist_columns_brief): Definitions of the brief and detailed key
	listing.
	(keyring_editor_new): Use keylist_columns_brief to initialize the
	key list

	(add_details_row):
	(keyring_details_notebook):
	(keyring_update_details_page): Turn the fingerprint label in the
	details notebook into an uneditable entry field so that users can
	copy and paste the fingerprint. To that end add a new parameter to
	add_details_row to indicate whether a label or entry is to be
	created.

	* keylist.c (keylist_fill_column_titles): Set the first
	keylist->ncolumns to visible.

2001-01-23	Jan-Oliver Wagner <jan@intevation.de>

	* simple-gettext.c: (new) "simple gettext method for
	Windows (copied from gnupg
	* Makefile.am: added simple-gettext

2001-01-23  Bernhard Herzog  <bh@intevation.de>

	* Makefile.am (gpa_SOURCES): Add the keylist files.

	* keylist.h: 
	* keylist.c: New files implementing the key list of the key ring
	editor.

	* keyring.c (keyring_editor_new):
	(keyring_editor_edit_trust):
	(keyring_editor_delete):
	(keyring_editor_sign):
	(keyring_editor_export): replace the CList of the keys with the
	keylist of keylist.c and modify all functions that use it to use
	the appropriate functions of keylist.c

	(keyring_editor_has_selection):
	(keyring_editor_has_single_selection):
	(keyring_editor_fill_keylist): 
	(keyring_editor_current_key_id): 
	(keyring_editor_current_key): 
	These function are now just frontends for the corresponding
	functions in keylist.c

2001-01-23	Jan-Oliver Wagner	<jan@intevation.de>

	* w32reg: new module copied from gnupg
	Access to Windows Registry
	* Makefile.am: added w32reg
	* gpa.c (main): now reads from Registry under Windows

2001-01-22  Bernhard Herzog  <bh@intevation.de>

	* keyring.c (keyring_editor_delete): Ask for confirmation before
	deleting keys.

2001-01-19  Bernhard Herzog  <bh@intevation.de>

	* keyring.c (keyring_editor_can_sign): Check whether the default
	has already signed the selected key and return FALSE in that case.
	(keyring_editor_current_key_id): New function that returns the id
	of the currently selected key.

	* gpa.c (main): Read the gtkrc file
	* Makefile.am: Add the gtkrc file
	* gtkrc: New file with GTK style defaults

	* keyring.c (keyring_editor_selection_changed):
	(keyring_editor_end_selection):
	(keyring_editor_fill_keylist):
	(keyring_editor_menubar_new): make them static

	(add_selection_sensitive_widget): Add the callback as a new
	parameter.
	(GPA_SENSITIVE_BUTTON): Get rid of this widget and use
	add_selection_sensitive_widget.

	(keyring_editor_new): Add a notebook showing details of the
	selected key and a toolbar at the top which replaces the buttons
	at the bottom
	(GPAKeyringEditor): Add three new fields for the labels of the
	details view.

	(keyring_toolbar_new): New function to create the new toolbar
	(toolbar_import_keys):
	(toolbar_export_key):
	(toolbar_sign_key):
	(toolbar_remove_key):
	(toolbar_edit_key): Signal handlers for the toolbar.

	(add_details_row):
	(keyring_details_notebook):
	(keyring_update_details_page): New functions to create and update
	the new details notebook.

	(keyring_editor_current_key): New function to return the currently
	selected key.

	(keyring_selection_update_widgets): New function that bundles all
	the updates that have to happen when the selection changes. Change
	the relevant signal handlers to use it.

	(keyring_editor_fill_keylist): The "show ownertrust" button is
	unavailable for now, so assume that it's not checked by default,
	just to make it work without the button.

	(keyring_editor_delete): Check for the existence of a private key
	and delete that first if it exists.

	* keyring.c: Substantial code reorganization

2001-01-18  Bernhard Herzog  <bh@intevation.de>

	* gpa.c (cmd_and_opt_values): 
	(opts):
	(main): 
	Rename the option simplified-ui to advanced-ui and
	reverse its meaning. The simplified UI is now the default.
	
	* keyring.c (keyring_editor_menubar_new): Add ... to "generate
	key" because it pops up a dialog

2001-01-17  Bernhard Herzog  <bh@intevation.de>

	* keyring.c (keyring_editor_can_sign): Change the condition.
	Signing is possible when at least one key is selected and there is
	a default key.

	(keyring_editor_generate_key_simple):
	(keyring_editor_generate_key_advanced): Update the default key and
	make sure all potentially sensitive widgets are updated.

	* keysigndlg.h (gpa_key_sign_run_dialog): Update the parameter
	list.
	
	* keysigndlg.c (gpa_key_sign_run_dialog): Remove the list box with
	the secret keys and the key_id paramter because we assume the
	selected keys are always signed with the default key. Also, in
	simplified ui mode, don't show the "sign locally" check box and
	set dialog.check_local to NULL.
	(key_sign_ok): Check whether dialog->check_local is NULL, i.e.
	whether the dialog was created in simplified ui mode, before
	retrieving the value. If it's NULL, set sign_type to normal.
	(struct _GPAKeySignDialog): remove the key_id field and update all
	users.

	* keyring.c (keyring_editor_sign): Change default sign type to
	normal which is probably better for the simplified UI mode. Also,
	private_key_id is the default key now, because it's not a retrun
	value of the key sign dialog anymore.

	* gpa.c (gpa_determine_default_key): New function to guess a
	useful default key.
	(main): Use gpa_determine_default_key to initialize the default
	key.

	* gtktools.c (gpa_window_error): Make the messenger parameter
	optional, i.e. it may be NULL now, so that gpa_callback can be
	used with NULL as calldata.

	* gpa.h:
	* gpa.c: Turn the definition of opt in gpa.h into an extern
	declaration and define it in gpa.c. Rename it to gpa_options. Fix
	all references to it. Introduce a typedef for the struct.

	* keysigndlg.h: 
	* keysigndlg.c (gpa_key_sign_run_dialog): Add the key to be signed
	to the parameter list and display its user id and fingerprint.

	* keyring.c (keyring_editor_generate_key_advanced): Do some error
	checking after generating the key pair.
	(keyring_editor_sign): Run the keysing dialog for each selected
	key separately

2001-01-16  Bernhard Herzog  <bh@intevation.de>

	* filemenu.c (file_sign_dialog): 
	* gpawidgets.c (gpa_secret_key_list_new): 
	* optionsmenu.c (gpa_loadOptionsSelect_ok):
	(gpa_saveOptionsSelect_ok):
	(options_key_set):
	(options_key): Use gpa_default_key and gpa_set_default_key instead
	of accessing global_defaultKey directly.
	
	* gpa.h: Add the two new functions gpa_default_key
	gpa_set_default_key

	* gpa.c (global_defaultKey):
	(gpa_default_key):
	(gpa_set_default_key): Turn global_defaultKey into a static
	varible default_key and introduce gpa_set_default_key and
	gpa_default_key to set and get its value

	* gpa.c (gpa_popupMenu_init):
	(global_popupMenu) Removed because they're no longer used.

	* gpa.h: Removed global_tempWindows

	* gpa.c: 
	* gpawindowkeeper.c: 
	Moved global_tempWindows to gpawindowkeeper as it's only used
	there, made it static and renamed it to tempWindows because it's
	not a global variable anymore.
	

2001-01-15  Bernhard Herzog  <bh@intevation.de>

	* keygenwizard.c (gpa_keygen_wizard_final_page): 
	Fix typo

	* keyring.c: Add and update comments
	(keyring_editor_can_sign): New function. Sensitivity callback for
	the sign key button.

	* keyring.c (keyring_editor_generate_key):
	(keyring_editor_generate_key_advanced): Renamed
	keyring_editor_generate_key to
	keyring_editor_generate_key_advanced.

	(keyring_editor_generate_key_simple): New function to call the key
	generation wizard

	(keyring_editor_generate_key): New function. Depending on the
	simple_ui flag call either keyring_editor_generate_key_advanced or
	keyring_editor_generate_key_simple

	(keyring_editor_mapped): New function. Signal handler handler for
	the map signal. If the simple_ui flag is set and no private key
	is in the keyring, suggest creating a new keypair.

	(keyring_editor_new): Connect to the map signal

	* gpawizard.c: 
	* gpawizard.h: 
	New files implementing a simple generic wizard interface

	* keygenwizard.h: 
	* keygenwizard.c: 
	New files implementing the key generation wizard

	* Makefile.am: Add the new files.

	* keygendlg.c (gpa_key_gen_run_dialog): Connect to delete-event
	and use the new gpa_window_show_centered function.

	* gtktools.h: Update the prototype of gpa_button_set_text and add
	the new message box functions

	* gtktools.c (gpa_button_set_text): Handle accelerators

	(message_box_delete): 
	(message_box_clicked): 
	(gpa_message_box_run): 

	New functions implementing a flexible message box with caller
	definable buttons.

	* gpa.h: Add the prototypes for gpa_simplified_ui and
	gpa_set_simplified_ui

	* gpa.c (opts): 
	(cmd_and_opt_values)
	Add a new option "simplified-ui" to turn on the simplified interface
	(gpa_simplified_ui): 
	(gpa_set_simplified_ui): 
	New functions to read and set the simplified ui flag

	(main): handle the simplified ui option in argument parsing

2001-01-11  Bernhard Herzog  <bh@intevation.de>

	* keysigndlg.c (gpa_key_sign_run_dialog):
	(key_sign_delete): Add signal handler for the delete-event signal.
	(gpa_key_sign_run_dialog): Use gpa_window_show_centered instead of
	gpa_widget_show

	* passphrasedlg.c 
	Add some comments
	(gpa_passphrase_run_dialog): The handler for the
	delete-event expected to be connected with gtk_signal_connect not
	with gtk_signal_connect_object.
	Use the new gpa_window_show_centered function
	(passphrase_delete_event): Return FALSE to indicate that the
	window is to be closed.

	* gtktools.c (gpa_window_show_centered): Make it actually work.

2001-01-10  Bernhard Herzog  <bh@intevation.de>

	* gtktools.c (gpa_window_show_centered): Removed the debug
	printf()s

2001-01-09  Bernhard Herzog  <bh@intevation.de>

	* gtktools.c (gpa_window_show_centered): New function. This is a
	better way to center windows and it should replace
	gpa_widget_set_centered one day.
	(gpa_window_error): Use the new gpa_window_show_centered instead
	of gpa_widget_show
	(gpa_button_set_text): New function to update the text of a button
	widget

	* gtktools.h: Add the two new function in gtktools.c

	* gpa.c (evalMouseClistFile): 
	(gpa_menubar_new):
	(delete_event): 
	(evalKeyClistFile): 

	Removed because they're no longer used

	* keyexportdlg.c (key_export_dialog_run): 
	get rid of the gpa_space_new () call

2001-01-05  Bernhard Herzog  <bh@intevation.de>

	* encryptdlg.c
	* encryptdlg.h
	* fileman.c
	* fileman.h
	* filesigndlg.c
	* filesigndlg.h
	* gpapastrings.c
	* gpapastrings.h
	* gpawidgets.c
	* gpawidgets.h
	* help.h
	* keyexportdlg.c
	* keyexportdlg.h
	* keygendlg.c
	* keygendlg.h
	* keyreceivedlg.c
	* keyreceivedlg.h
	* keyring.c
	* keyring.h
	* keysigndlg.c
	* keysigndlg.h
	* ownertrustdlg.c
	* ownertrustdlg.h
	* passphrasedlg.c
	* passphrasedlg.h
	* tipwindow.c
	new files

	* filemenu.c:
	* gpa.c: 
	* gpa.h: 
	* gtktools.c: 
	* gtktools.h: 
	* help.c: 
	* helpmenu.c: 
	* helpmenu.h: 
	* optionsmenu.c: 
	* optionsmenu.h: 

	A lot of changes and reorganization of the code. Much of the code
	is now in the new files.

	The reorganization has two goals: 
	
	1. Change the user interface to make the keyring editor the main
	window.

	2. Internal changes to make the code more object oriented and more
	maintainable.

	The changes are very extensive and touch practically all parts of
	the UI code.

	* Makefile.am: Added the new files

2000-09-01  Werner Koch  <wk@gnupg.org>

	* icons.c, icons.h: New.  Changed all other includes of icons.xpm
	to icons.h.
	* gpa.c (gpa_file_toolbar_new): Use this new function here.
	* gtktools.c (gpa_xpm_label_box): Ditto
	* keysmenu.c (getIconNameForOwnertrust): Replaces
	getIconForOwnertrust.  Chnaged all callers to provide a string now.
	
2000-08-17  Werner Koch  <wk@gnupg.org>

	* gpa.c (i18n_init,main): Fixed locale setting as suggested by
	Clive Lin.

2000-07-25 09:02:34  Werner Koch  (wk@habibti.openit.de)

  * gpa.c (gpa_windowTips_show): Moved from here to ...
  * help.c: ... here.  Complete rewrote to read the tips rom a file.
  (get_language): New.
  (gpa_tips.en, gpa_tips.de): New.

2000-06-28 17:23:03  Werner Koch  (wk@habibti.openit.de)

  * gpa.c:  Removed the --tooltip-kludge option, becuase the bug as
  been fixed meanwhile.
  * gtktools.c (gpa_widget_show): Removed it here too.

2000-06-28 15:32:07  Jan-Oliver Wagner (jan@intevation.de)

  * gtktools.c (gpa_widget_set_centered): fixed minimization bug
  * icons.xpm: replaced temporary icons and added ownertrust icons
  * keysmenu.c: added icon to button 'sign' in public keyring editor dialog,
  added ownertrust icons in keylist of public keyring editor dialog

2000-06-23 16:05:04  Jan-Oliver Wagner (jan@intevation.de)

  * keysmenu.c: added icon to the delete button in the
  public keyring editor dialog

2000-06-23 16:00:53  Jan-Oliver Wagner (jan@intevation.de)

  * icons.xpm: added a trashcan (taken from KDE)

2000-06-23 10:11:02  Jan-Oliver Wagner (jan@intevation.de)

  * icons.xpm: test icons for tool bar added

2000-06-23 10:10:44  Jan-Oliver Wagner (jan@intevation.de)

  * gpa.c: test icons for tool bar added, seldom actions removed from toolbar

2000-06-22 13:27:35  Jan-Oliver Wagner (jan@intevation.de)

  * icons.xpm: new file, contains icon xpm's. Just tempory until
  icons are treated in a more convenient way.

2000-06-20 16:45:31  Jan-Oliver Wagner (jan@intevation.de)

  * gpa.c: added toolbar for main window - experimental stage, but functioning

2000-05-25 17:54:29  Werner Koch  (wk@habibti.openit.de)

  * gpa.c (main): Add a call to gpapa_init

  New option --gpg-program.

2000-05-24 10:01:06  Werner Koch  (wk@habibti.openit.de)

  * gpa.c (gpa_menubar_new): Reformated menu list.
  * helpmenu.c (help_version): renamed to ...
  (help_about): .. this and implemented.

  * gpa.c, gpa.h (namesKeyservers): Replaced by ..
  (main): ... opt.keyserver_names and malloced array.
  * optionsmenu.c (options_keyserver): Put all keyservers into the list.

  * gtktools.c (gpa_widget_show): Kludge for Sawmill and Windowmaker.

2000-05-16 19:57:28  Werner Koch  (wk@habibti.openit.de)

  Ran "indent -gnu -sc" on all source files.

2000-05-04 18:40:08  Werner Koch  (wk@habibti.openit.de)

  * *.c: Moved all gpa_widget_set_centered() before the
  gtk_widget_show_all(), so that the windows are displayed correctly.

2000-05-02 19:57:29  Werner Koch  (wk@habibti.openit.de)

  * gpa.c, keymenu.c, filemenu.c: Removed libiberty header.
  * gpa.h: Included xmalloc header.


